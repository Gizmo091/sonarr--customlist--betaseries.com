# BetaSeries to Sonarr Custom List Generator

This service allows you to generate Sonarr-compatible custom lists from your BetaSeries library. It fetches your TV shows from BetaSeries and provides them in the format expected by Sonarr's custom list feature.

## üåê Demo

Try the live demo interface: **[https://bslg.vedielaute.fr/](https://bslg.vedielaute.fr/)**

You can test the service without installing anything locally!

## Features

- Fetch TV shows from any BetaSeries user's library
- Filter shows by status (current, active, archived, completed, etc.)
- Generate unique URLs for each user/status combination
- Simple web interface for managing configurations
- Compatible with Sonarr's custom list import feature

## Prerequisites

- Node.js (v14 or higher)
- A BetaSeries API key ([Get one here](https://www.betaseries.com/api/))

## Installation

1. Clone this repository:
```bash
git clone https://github.com/yourusername/betaserie-sonarr-custom-list-generator.git
cd betaserie-sonarr-custom-list-generator
```

2. Install dependencies:
```bash
npm install
```

3. Create a `.env` file based on `.env.example`:
```bash
cp .env.example .env
```

4. Edit `.env` and add your BetaSeries API key:
```
BETASERIES_API_KEY=your_api_key_here
PORT=3000
```

5. Start the server:
```bash
npm start
```

The service will be available at `http://localhost:3000`

## Usage

### Web Interface

1. Open `http://localhost:3000` in your browser
2. Get your Member ID:
   - If you know it: Enter it directly in the form
   - If you don't know it: Use the login form at the top to retrieve it
3. Select the status filter you want to use
4. Click "Generate List URL"
5. Copy the generated URL and use it in Sonarr

### Adding to Sonarr

1. In Sonarr, go to Settings ‚Üí Lists
2. Click the + button to add a new list
3. Select "Custom List"
4. Configure as follows:
   - Name: Give your list a name (e.g., "BetaSeries - Active Shows")
   - Enable Automatic Add: Yes (if you want shows to be added automatically)
   - List URL: Paste the URL generated by this service
   - Quality Profile: Select your preferred quality profile
   - Root Folder: Select where to store the shows
5. Save the list

## API Endpoints

- `GET /api/list/:id` - Get the Sonarr-formatted list for a configuration
- `POST /api/configurations` - Create a new configuration
- `GET /api/configurations` - List all configurations
- `DELETE /api/configurations/:id` - Delete a configuration
- `POST /api/auth` - Authenticate with BetaSeries to get Member ID

## Status Options

- `current` - Shows currently being watched
- `active` - Active shows
- `archived` - Archived shows
- `archived_and_completed` - Archived shows that are completed
- `archived_and_not_started` - Archived shows that haven't been started
- `completed` - Completed shows
- `active_and_completed` - Active shows that are completed
- `not_started` - Shows that haven't been started
- `stopped` - Shows that were stopped

## Data Storage

Configurations and cache are stored in JSON files within the data directory. By default, this is `./data` relative to the application, but can be customized using the `DATA_DIR` environment variable.

## Environment Variables

| Variable | Required | Default | Description |
|----------|----------|---------|-------------|
| `BETASERIES_API_KEY` | Yes | - | Your BetaSeries API key |
| `SESSION_SECRET` | Yes | - | Secret key for session encryption |
| `PORT` | No | `3000` | Port for the web server |
| `DATA_DIR` | No | `./data` | Directory for storing configurations and cache |

### DATA_DIR Examples:
- **Local development**: Use default `./data`
- **Custom path**: `/var/app/betaseries-data`
- **Docker**: `/app/data`
- **Render**: `/opt/render/project/data`

## Development

To run in development mode with auto-restart:
```bash
npm run dev
```

## Security Notes

- Keep your `.env` file secure and never commit it to version control
- The BetaSeries API key should be kept confidential
- Consider implementing authentication if deploying this service publicly

## Deployment on Render

### Step-by-step deployment guide:

1. **Push to GitHub**:
   ```bash
   git add .
   git commit -m "Prepare for Render deployment"
   git push origin main
   ```

2. **Create Render account**: Go to [render.com](https://render.com) and sign up

3. **Create new Web Service**:
   - Click "New +" ‚Üí "Web Service"
   - Connect your GitHub repository
   - Select your repository

4. **Configure the service**:
   - **Name**: `betaseries-sonarr-list` (or your preferred name)
   - **Environment**: `Node`
   - **Region**: Choose closest to your location
   - **Branch**: `main`
   - **Build Command**: `npm install`
   - **Start Command**: `npm start`

5. **Set Environment Variables**:
   In the "Environment" section, add:
   ```
   BETASERIES_API_KEY=your_actual_api_key
   SESSION_SECRET=a_very_long_random_string
   DATA_DIR=/opt/render/project/data
   ```

6. **Deploy**: Click "Create Web Service"

7. **Get your URL**: Once deployed, Render will provide a URL like:
   `https://your-app-name.onrender.com`

### Important Notes for Production:

- **Data Persistence**: Files in `/data` will be lost on restart
- **Consider PostgreSQL**: For persistent data, add a PostgreSQL database
- **SSL**: Render provides HTTPS automatically
- **Custom Domain**: Available on paid plans

### Free Tier Limitations:

- Apps sleep after 15 minutes of inactivity
- 750 hours/month (enough for most personal use)
- Slower startup time after sleeping

## License

MIT